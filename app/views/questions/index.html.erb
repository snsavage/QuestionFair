
<div class="col-md-2">

  <div class="panel panel-default">
    <div class="panel-heading">Search Nearby</div>
    <div class="panel-body">
      <%= form_tag questions_path, :method => 'get', class: "form-group", role: "search" do %>
        <div class="form-group">
          <%= label_tag "Search Nearby", nil, class: "control-label" %>
          <%= text_field_tag :location, 
            params[:location], 
            id: "location_city_state",
            data: {autocomplete_source: geo_search_questions_path },
            class: "form-control", 
            placeholder: "City, State" %>
        </div>
        <div class="form-group">
          <%= label_tag "Distance", nil, class: "control-label" %>
          <%= select_tag :distance, options_for_select(Question.distances, @distance.to_i), class: "form-control" %>
        </div>
        <%= submit_tag "Search", name: nil, class: "btn btn-default" %>
      <% end %>
    </div>
  </div>

  <div class="panel panel-default">
    <div class="panel-heading">Categories</div>
    <div class="list-group" >
      <% Question.category_list_with_all.sort.each do |category| %>
        <% if category == @category %>
            <%= link_to category.titleize, {:controller => "questions", :action => "index", :category => category }, class: "list-group-item active" %>
        <% else %>
            <%= link_to category.titleize, {:controller => "questions", :action => "index", :category => category }, class: "list-group-item" %>
        <% end %>
      <% end %>
    </div>
    <div class="panel-footer">
      <%= link_to "Suggest New Category", contact_path(from: "Category Suggestion"), 
        class: "text-center" %>
    </div>
  </div>
</div>

<div class="col-md-8">
  <% if @questions.count == 0 %>
    <div class="col-md-12 text-center">
      <h4>No questions have been asked in the <%= @category.titleize %> category.</h4>
      <h4><small><%= link_to "Click Here", new_question_path %> to ask a new question.</small></h4>
    </div>
  <% elsif %>
  
    <% if @category == "All" %>
      <h3 class="recent-questions">All Recent Questions</h3>
    <% else %>
      <h3 class="recent-questions"><%= @category.singularize.titleize %> Questions</h3>
    <% end %>

    <div class="text-center">
      <%= will_paginate @questions, class: "pagination-sm", renderer: BootstrapPagination::Rails %>
    </div>

    <% @questions.each do |question| %>

      <div class="col-md-12">
        <div class="row">
          <div class="col-sm-8">
            <h4><%= link_to question.question, question_path(question) %></h4>
          </div>
          <div class="col-sm-4">
            <h5 class="text-right">Answers 
              <span class="badge"><%= question.answers_count %></span>
            </h5>
          </div>
        </div>
        <div class="row">
          <div class="col-sm-8">
            <h4><small>Asked by <%= link_to question.user.nickname, user_path(question.user) %> 
              <%= time_ago_in_words(question.created_at, include_seconds: false) %> ago. </small></h4>
          </div>
          <div class="col-sm-4">
            <h5 class="text-right">
              <%= link_to question.category, questions_path(category: question.category), class: "label label-info" %>
            </h5>
            <% if question.has_address? %>
              <h5 class="text-right">
                <%= link_to question.create_address, questions_path(location: question.create_address), 
                  class: "label label-success" %>
              </h5>
            <% end %>
          </div>
        </div>
        <hr />
      </div>
      
    <% end %>

    <div class="text-center">
      <%= will_paginate @questions, class: "pagination-sm", renderer: BootstrapPagination::Rails %>
    </div>

  <% end %> 

</div>
